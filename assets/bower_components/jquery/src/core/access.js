define(["../core"],function(e){var t=function(n,r,i,o,a,s,u){var c=0,l=n.length,f=null==i;if("object"===e.type(i)){a=!0;for(c in i)t(n,r,c,i[c],!0,s,u)}else if(void 0!==o&&(a=!0,e.isFunction(o)||(u=!0),f&&(u?(r.call(n,o),r=null):(f=r,r=function(t,n,r){return f.call(e(t),r)})),r))for(;l>c;c++)r(n[c],i,u?o:o.call(n[c],c,r(n[c],i)));return a?n:f?r.call(n):l?r(n[0],i):s};return t});