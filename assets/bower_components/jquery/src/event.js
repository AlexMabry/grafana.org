define(["./core","./var/strundefined","./var/rnotwhite","./var/hasOwn","./var/slice","./event/support","./data/var/data_priv","./core/init","./data/accepts","./selector"],function(t,e,n,r,i,o,u){function a(){return!0}function c(){return!1}function l(){try{return document.activeElement}catch(t){}}var s=/^key/,f=/^(?:mouse|pointer|contextmenu)|click/,d=/^(?:focusinfocus|focusoutblur)$/,p=/^([^.]*)(?:\.(.+)|)$/;return t.event={global:{},add:function(r,i,o,a,c){var l,s,f,d,h,v,g,m,y,_,b,w=u.get(r);if(w)for(o.handler&&(l=o,o=l.handler,c=l.selector),o.guid||(o.guid=t.guid++),(d=w.events)||(d=w.events={}),(s=w.handle)||(s=w.handle=function(n){return typeof t!==e&&t.event.triggered!==n.type?t.event.dispatch.apply(r,arguments):void 0}),i=(i||"").match(n)||[""],h=i.length;h--;)f=p.exec(i[h])||[],y=b=f[1],_=(f[2]||"").split(".").sort(),y&&(g=t.event.special[y]||{},y=(c?g.delegateType:g.bindType)||y,g=t.event.special[y]||{},v=t.extend({type:y,origType:b,data:a,handler:o,guid:o.guid,selector:c,needsContext:c&&t.expr.match.needsContext.test(c),namespace:_.join(".")},l),(m=d[y])||(m=d[y]=[],m.delegateCount=0,g.setup&&g.setup.call(r,a,_,s)!==!1||r.addEventListener&&r.addEventListener(y,s,!1)),g.add&&(g.add.call(r,v),v.handler.guid||(v.handler.guid=o.guid)),c?m.splice(m.delegateCount++,0,v):m.push(v),t.event.global[y]=!0)},remove:function(e,r,i,o,a){var c,l,s,f,d,h,v,g,m,y,_,b=u.hasData(e)&&u.get(e);if(b&&(f=b.events)){for(r=(r||"").match(n)||[""],d=r.length;d--;)if(s=p.exec(r[d])||[],m=_=s[1],y=(s[2]||"").split(".").sort(),m){for(v=t.event.special[m]||{},m=(o?v.delegateType:v.bindType)||m,g=f[m]||[],s=s[2]&&new RegExp("(^|\\.)"+y.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=c=g.length;c--;)h=g[c],!a&&_!==h.origType||i&&i.guid!==h.guid||s&&!s.test(h.namespace)||o&&o!==h.selector&&("**"!==o||!h.selector)||(g.splice(c,1),h.selector&&g.delegateCount--,v.remove&&v.remove.call(e,h));l&&!g.length&&(v.teardown&&v.teardown.call(e,y,b.handle)!==!1||t.removeEvent(e,m,b.handle),delete f[m])}else for(m in f)t.event.remove(e,m+r[d],i,o,!0);t.isEmptyObject(f)&&(delete b.handle,u.remove(e,"events"))}},trigger:function(e,n,i,o){var a,c,l,s,f,p,h,v=[i||document],g=r.call(e,"type")?e.type:e,m=r.call(e,"namespace")?e.namespace.split("."):[];if(c=l=i=i||document,3!==i.nodeType&&8!==i.nodeType&&!d.test(g+t.event.triggered)&&(g.indexOf(".")>=0&&(m=g.split("."),g=m.shift(),m.sort()),f=g.indexOf(":")<0&&"on"+g,e=e[t.expando]?e:new t.Event(g,"object"==typeof e&&e),e.isTrigger=o?2:3,e.namespace=m.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=i),n=null==n?[e]:t.makeArray(n,[e]),h=t.event.special[g]||{},o||!h.trigger||h.trigger.apply(i,n)!==!1)){if(!o&&!h.noBubble&&!t.isWindow(i)){for(s=h.delegateType||g,d.test(s+g)||(c=c.parentNode);c;c=c.parentNode)v.push(c),l=c;l===(i.ownerDocument||document)&&v.push(l.defaultView||l.parentWindow||window)}for(a=0;(c=v[a++])&&!e.isPropagationStopped();)e.type=a>1?s:h.bindType||g,p=(u.get(c,"events")||{})[e.type]&&u.get(c,"handle"),p&&p.apply(c,n),p=f&&c[f],p&&p.apply&&t.acceptData(c)&&(e.result=p.apply(c,n),e.result===!1&&e.preventDefault());return e.type=g,o||e.isDefaultPrevented()||h._default&&h._default.apply(v.pop(),n)!==!1||!t.acceptData(i)||f&&t.isFunction(i[g])&&!t.isWindow(i)&&(l=i[f],l&&(i[f]=null),t.event.triggered=g,i[g](),t.event.triggered=void 0,l&&(i[f]=l)),e.result}},dispatch:function(e){e=t.event.fix(e);var n,r,o,a,c,l=[],s=i.call(arguments),f=(u.get(this,"events")||{})[e.type]||[],d=t.event.special[e.type]||{};if(s[0]=e,e.delegateTarget=this,!d.preDispatch||d.preDispatch.call(this,e)!==!1){for(l=t.event.handlers.call(this,e,f),n=0;(a=l[n++])&&!e.isPropagationStopped();)for(e.currentTarget=a.elem,r=0;(c=a.handlers[r++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(c.namespace))&&(e.handleObj=c,e.data=c.data,o=((t.event.special[c.origType]||{}).handle||c.handler).apply(a.elem,s),void 0!==o&&(e.result=o)===!1&&(e.preventDefault(),e.stopPropagation()));return d.postDispatch&&d.postDispatch.call(this,e),e.result}},handlers:function(e,n){var r,i,o,u,a=[],c=n.delegateCount,l=e.target;if(c&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!==this;l=l.parentNode||this)if(l.disabled!==!0||"click"!==e.type){for(i=[],r=0;c>r;r++)u=n[r],o=u.selector+" ",void 0===i[o]&&(i[o]=u.needsContext?t(o,this).index(l)>=0:t.find(o,this,null,[l]).length),i[o]&&i.push(u);i.length&&a.push({elem:l,handlers:i})}return c<n.length&&a.push({elem:this,handlers:n.slice(c)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var n,r,i,o=e.button;return null==t.pageX&&null!=e.clientX&&(n=t.target.ownerDocument||document,r=n.documentElement,i=n.body,t.pageX=e.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),t.pageY=e.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),t.which||void 0===o||(t.which=1&o?1:2&o?3:4&o?2:0),t}},fix:function(e){if(e[t.expando])return e;var n,r,i,o=e.type,u=e,a=this.fixHooks[o];for(a||(this.fixHooks[o]=a=f.test(o)?this.mouseHooks:s.test(o)?this.keyHooks:{}),i=a.props?this.props.concat(a.props):this.props,e=new t.Event(u),n=i.length;n--;)r=i[n],e[r]=u[r];return e.target||(e.target=document),3===e.target.nodeType&&(e.target=e.target.parentNode),a.filter?a.filter(e,u):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==l()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===l()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&t.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return t.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}},simulate:function(e,n,r,i){var o=t.extend(new t.Event,r,{type:e,isSimulated:!0,originalEvent:{}});i?t.event.trigger(o,null,n):t.event.dispatch.call(n,o),o.isDefaultPrevented()&&r.preventDefault()}},t.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n,!1)},t.Event=function(e,n){return this instanceof t.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?a:c):this.type=e,n&&t.extend(this,n),this.timeStamp=e&&e.timeStamp||t.now(),void(this[t.expando]=!0)):new t.Event(e,n)},t.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=a,t&&t.preventDefault&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=a,t&&t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=a,t&&t.stopImmediatePropagation&&t.stopImmediatePropagation(),this.stopPropagation()}},t.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,n){t.event.special[e]={delegateType:n,bindType:n,handle:function(e){var r,i=this,o=e.relatedTarget,u=e.handleObj;return(!o||o!==i&&!t.contains(i,o))&&(e.type=u.origType,r=u.handler.apply(this,arguments),e.type=n),r}}}),o.focusinBubbles||t.each({focus:"focusin",blur:"focusout"},function(e,n){var r=function(e){t.event.simulate(n,e.target,t.event.fix(e),!0)};t.event.special[n]={setup:function(){var t=this.ownerDocument||this,i=u.access(t,n);i||t.addEventListener(e,r,!0),u.access(t,n,(i||0)+1)},teardown:function(){var t=this.ownerDocument||this,i=u.access(t,n)-1;i?u.access(t,n,i):(t.removeEventListener(e,r,!0),u.remove(t,n))}}}),t.fn.extend({on:function(e,n,r,i,o){var u,a;if("object"==typeof e){"string"!=typeof n&&(r=r||n,n=void 0);for(a in e)this.on(a,n,r,e[a],o);return this}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),i===!1)i=c;else if(!i)return this;return 1===o&&(u=i,i=function(e){return t().off(e),u.apply(this,arguments)},i.guid=u.guid||(u.guid=t.guid++)),this.each(function(){t.event.add(this,e,i,r,n)})},one:function(t,e,n,r){return this.on(t,e,n,r,1)},off:function(e,n,r){var i,o;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,t(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(o in e)this.off(o,n,e[o]);return this}return(n===!1||"function"==typeof n)&&(r=n,n=void 0),r===!1&&(r=c),this.each(function(){t.event.remove(this,e,r,n)})},trigger:function(e,n){return this.each(function(){t.event.trigger(e,n,this)})},triggerHandler:function(e,n){var r=this[0];return r?t.event.trigger(e,n,r,!0):void 0}}),t});