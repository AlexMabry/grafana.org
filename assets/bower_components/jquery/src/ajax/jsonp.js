define(["../core","./var/nonce","./var/rquery","../ajax"],function(t,e,n){var r=[],i=/(=)\?(?=&|$)|\?\?/;t.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var n=r.pop()||t.expando+"_"+e++;return this[n]=!0,n}}),t.ajaxPrefilter("json jsonp",function(e,o,a){var s,u,l,c=e.jsonp!==!1&&(i.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&i.test(e.data)&&"data");return c||"jsonp"===e.dataTypes[0]?(s=e.jsonpCallback=t.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,c?e[c]=e[c].replace(i,"$1"+s):e.jsonp!==!1&&(e.url+=(n.test(e.url)?"&":"?")+e.jsonp+"="+s),e.converters["script json"]=function(){return l||t.error(s+" was not called"),l[0]},e.dataTypes[0]="json",u=window[s],window[s]=function(){l=arguments},a.always(function(){window[s]=u,e[s]&&(e.jsonpCallback=o.jsonpCallback,r.push(s)),l&&t.isFunction(u)&&u(l[0]),l=u=void 0}),"script"):void 0})});