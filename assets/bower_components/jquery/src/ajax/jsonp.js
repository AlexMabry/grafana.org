define(["../core","./var/nonce","./var/rquery","../ajax"],function(e,t,n){var r=[],i=/(=)\?(?=&|$)|\?\?/;e.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var n=r.pop()||e.expando+"_"+t++;return this[n]=!0,n}}),e.ajaxPrefilter("json jsonp",function(t,o,a){var u,s,c,l=t.jsonp!==!1&&(i.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&i.test(t.data)&&"data");return l||"jsonp"===t.dataTypes[0]?(u=t.jsonpCallback=e.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,l?t[l]=t[l].replace(i,"$1"+u):t.jsonp!==!1&&(t.url+=(n.test(t.url)?"&":"?")+t.jsonp+"="+u),t.converters["script json"]=function(){return c||e.error(u+" was not called"),c[0]},t.dataTypes[0]="json",s=window[u],window[u]=function(){c=arguments},a.always(function(){window[u]=s,t[u]&&(t.jsonpCallback=o.jsonpCallback,r.push(u)),c&&e.isFunction(s)&&s(c[0]),c=s=void 0}),"script"):void 0})});