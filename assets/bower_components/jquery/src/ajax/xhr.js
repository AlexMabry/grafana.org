define(["../core","../var/support","../ajax"],function(e,t){e.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var n=0,r={},i={0:200,1223:204},o=e.ajaxSettings.xhr();window.attachEvent&&window.attachEvent("onunload",function(){for(var e in r)r[e]()}),t.cors=!!o&&"withCredentials"in o,t.ajax=o=!!o,e.ajaxTransport(function(e){var a;return t.cors||o&&!e.crossDomain?{send:function(t,o){var u,s=e.xhr(),c=++n;if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(u in e.xhrFields)s[u]=e.xhrFields[u];e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||t["X-Requested-With"]||(t["X-Requested-With"]="XMLHttpRequest");for(u in t)s.setRequestHeader(u,t[u]);a=function(e){return function(){a&&(delete r[c],a=s.onload=s.onerror=null,"abort"===e?s.abort():"error"===e?o(s.status,s.statusText):o(i[s.status]||s.status,s.statusText,"string"==typeof s.responseText?{text:s.responseText}:void 0,s.getAllResponseHeaders()))}},s.onload=a(),s.onerror=a("error"),a=r[c]=a("abort");try{s.send(e.hasContent&&e.data||null)}catch(l){if(a)throw l}},abort:function(){a&&a()}}:void 0})});