define(["../core","../var/support","../ajax"],function(t,e){t.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(t){}};var n=0,r={},i={0:200,1223:204},o=t.ajaxSettings.xhr();window.attachEvent&&window.attachEvent("onunload",function(){for(var t in r)r[t]()}),e.cors=!!o&&"withCredentials"in o,e.ajax=o=!!o,t.ajaxTransport(function(t){var a;return e.cors||o&&!t.crossDomain?{send:function(e,o){var s,u=t.xhr(),l=++n;if(u.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)u[s]=t.xhrFields[s];t.mimeType&&u.overrideMimeType&&u.overrideMimeType(t.mimeType),t.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");for(s in e)u.setRequestHeader(s,e[s]);a=function(t){return function(){a&&(delete r[l],a=u.onload=u.onerror=null,"abort"===t?u.abort():"error"===t?o(u.status,u.statusText):o(i[u.status]||u.status,u.statusText,"string"==typeof u.responseText?{text:u.responseText}:void 0,u.getAllResponseHeaders()))}},u.onload=a(),u.onerror=a("error"),a=r[l]=a("abort");try{u.send(t.hasContent&&t.data||null)}catch(c){if(a)throw c}},abort:function(){a&&a()}}:void 0})});